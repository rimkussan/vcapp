rimkus@DESKTOP-IHA3IIP:~/git/entraid$ ./launch-demo.sh
ğŸš€ Microsoft Entra ID + Next.js Authentication Demo
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ Project: nextjs-entraid-auth/example
ğŸ§¹ Cleaning up any existing processes...
ğŸŒ Starting development server...

â³ Waiting for server to start...

> example@0.1.0 dev
> next dev --turbopack --hostname 0.0.0.0 --port 3000

   â–² Next.js 15.4.6 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://0.0.0.0:3000
   - Environments: .env.local

 âœ“ Starting...
 âœ“ Compiled middleware in 320ms
 âœ“ Ready in 1565ms

âœ… Server started successfully!

ğŸŒ Access URLs:
   â€¢ Local: http://localhost:3000
   â€¢ Network: http://10.255.255.254:3000

ğŸ“‹ Features you can test:
   â€¢ Home page with demo interface
   â€¢ Click 'Protected Page' button (will redirect to login)
   â€¢ Click 'Admin Page' button (will redirect to login)
   â€¢ Sign in button (will show Entra ID setup needed)

ğŸ’¡ To enable full authentication:
   1. Set up Microsoft Entra ID app registration
   2. Edit .env.local with your real credentials
   3. Follow: ~/git/entraid/nextjs-entraid-auth/SETUP-GUIDE.md

ğŸ”§ Setting up Windows port forwarding...
   Run this in Windows PowerShell as Administrator:
   netsh interface portproxy delete v4tov4 listenport=3000
   netsh interface portproxy add v4tov4 listenport=3000 listenaddress=0.0.0.0 connectport=3000 connectaddress=127.0.0.1

â¹ï¸  Press Ctrl+C to stop the server
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[auth][warn][debug-enabled] Read more: https://warnings.authjs.dev
 â—‹ Compiling / ...
 âœ“ Compiled / in 2.4s
[auth][warn][debug-enabled] Read more: https://warnings.authjs.dev
 GET / 200 in 2777ms
[auth][debug]: CREATE_PKCECODEVERIFIER {
  "name": "authjs.pkce.code_verifier",
  "payload": "H0XKr7La-V_L5wclrrAvG2G3LM4tQOQhtjguDe6uZh8",
  "COOKIE_TTL": 900,
  "expires": "2025-08-20T12:27:43.717Z"
}
[auth][debug]: authorization url is ready {
  "url": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fapi%2Fauth%2Fcallback%2Fmicrosoft-entra-id&scope=openid+profile+email+offline_access&code_challenge=-CpE_zA-9_gDHRbpU67_YIzIVDCPU34iQ3YEJ7ttqgM&code_challenge_method=S256",
  "cookies": [
    {
      "name": "authjs.pkce.code_verifier",
      "value": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..jMYAXuOq6KPXioybVWQtPw.gF1vCJw1mB44gImzw7akG157_s-uITDA3YqIsjybjJ_r8UZLoNLJ9oW_WHh-wqhEkWuB1Jtw27cR3xhiUH0w-3wgpsNz9g7d4uvHpxvC8XI1ojcw9U1c4BPAoGybB1bg8GtcOwpScIRDwx3WT3e2AlTPNHGvEERSbajDIJjAzYmx-Mw3MTOjJwhCzCMAXh3y.Xx0mtXsGCtkdocRB5PUqt4XmqOdJC4DOwY3A1WtjRo4",
      "options": {
        "httpOnly": true,
        "sameSite": "lax",
        "path": "/",
        "secure": false,
        "maxAge": 900,
        "expires": "2025-08-20T12:27:43.717Z"
      }
    }
  ],
  "provider": {
    "id": "microsoft-entra-id",
    "name": "Microsoft Entra ID",
    "type": "oidc",
    "authorization": {
      "url": "https://authjs.dev/?scope=openid+profile+email+offline_access"
    },
    "style": {
      "text": "#fff",
      "bg": "#0072c6"
    },
    "clientId": "050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46",
    "clientSecret": "m6-8Q~B02nqBmQkY3X6b5iWhIj4izfT3P4X6jb97",
    "issuer": "https://login.microsoftonline.com/common/v2.0",
    "tenantId": "88035477-cea5-4eaf-bafc-efa3e368ad5e",
    "signinUrl": "http://localhost:3000/api/auth/signin/microsoft-entra-id",
    "callbackUrl": "http://localhost:3000/api/auth/callback/microsoft-entra-id",
    "wellKnown": "https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration",
    "checks": [
      "pkce"
    ]
  }
}
 POST / 303 in 301ms
 â—‹ Compiling /api/auth/[...nextauth] ...
 âœ“ Compiled /api/auth/[...nextauth] in 500ms
[auth][warn][debug-enabled] Read more: https://warnings.authjs.dev
[auth][debug]: USE_PKCECODEVERIFIER {
  "value": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..jMYAXuOq6KPXioybVWQtPw.gF1vCJw1mB44gImzw7akG157_s-uITDA3YqIsjybjJ_r8UZLoNLJ9oW_WHh-wqhEkWuB1Jtw27cR3xhiUH0w-3wgpsNz9g7d4uvHpxvC8XI1ojcw9U1c4BPAoGybB1bg8GtcOwpScIRDwx3WT3e2AlTPNHGvEERSbajDIJjAzYmx-Mw3MTOjJwhCzCMAXh3y.Xx0mtXsGCtkdocRB5PUqt4XmqOdJC4DOwY3A1WtjRo4"
}
[auth][debug]: PARSE_PKCECODEVERIFIER {
  "cookie": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..jMYAXuOq6KPXioybVWQtPw.gF1vCJw1mB44gImzw7akG157_s-uITDA3YqIsjybjJ_r8UZLoNLJ9oW_WHh-wqhEkWuB1Jtw27cR3xhiUH0w-3wgpsNz9g7d4uvHpxvC8XI1ojcw9U1c4BPAoGybB1bg8GtcOwpScIRDwx3WT3e2AlTPNHGvEERSbajDIJjAzYmx-Mw3MTOjJwhCzCMAXh3y.Xx0mtXsGCtkdocRB5PUqt4XmqOdJC4DOwY3A1WtjRo4"
}
[auth][debug]: CLEAR_PKCECODEVERIFIER {
  "cookie": {
    "name": "authjs.pkce.code_verifier",
    "options": {
      "httpOnly": true,
      "sameSite": "lax",
      "path": "/",
      "secure": false,
      "maxAge": 900
    }
  }
}
[auth][debug]: authorization result {
  "user": {
    "id": "b40edfd7-f884-4bf2-b2c6-c467248219d5",
    "name": "Andrejs Rimsevics",
    "email": "andrejs.r@xperience.lv",
    "image": null
  },
  "account": {
    "token_type": "bearer",
    "scope": "email openid profile",
    "expires_in": 3984,
    "ext_expires_in": 3984,
    "access_token": "eyJ0eXAiOiJKV1QiLCJub25jZSI6IlJYbnJaaVloY3V3U0c3T2ludUI2UXVjTEI3dlBDN2ZsRUFyOEk3UlJjdWMiLCJhbGciOiJSUzI1NiIsIng1dCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSIsImtpZCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8wMDY5NjdlZS0zZDg0LTQxZjktYTIyZC1mZjRhZGVjMjUzMjMvIiwiaWF0IjoxNzU1NjkxNzU0LCJuYmYiOjE3NTU2OTE3NTQsImV4cCI6MTc1NTY5NjA0MCwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsicDEiXSwiYWlvIjoiQVpRQWEvOFpBQUFBMkhUZUJUamMyZGthc3lhWFdlQTZoaWNlYXEzSkFsaDdmRXBsanNKeXJMVktvWG5zdENnY1NQSHB4WklKSDZycXg3NEErOEVNdHRpeUYwbXZ1dWtLaTJCaEdTSGlwZ3diRVBTQVVLVTd5b2IxWDJhY0swbmJOWkFxWERaNEtwR3UyT2cwY3ZnNGFhZDltYitleGE5eGtEQnJidzJqYWdqN1NaQjNFZlRaQ3BvTm8weUlFRHBJTnRYeGdCbGJzenVhIiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBfZGlzcGxheW5hbWUiOiJuZXh0anMtcG9jIiwiYXBwaWQiOiIwNTBlZDZkYS05YzFhLTRkYmUtYWU1OS1jYmJkMWNkNTZiNDYiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6IlJpbXNldmljcyIsImdpdmVuX25hbWUiOiJBbmRyZWpzIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiODMuOTkuMTM3LjczIiwibmFtZSI6IkFuZHJlanMgUmltc2V2aWNzIiwib2lkIjoiMjUyZTAxYjAtMTdmYi00YjU4LWIyOWQtNDdjODYxMGE1MGQyIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAzQTM4MDM1REIiLCJyaCI6IjEuQVlJQTdtZHBBSVE5LVVHaUxmOUszc0pUSXdNQUFBQUFBQUFBd0FBQUFBQUFBQUNxQUllQ0FBLiIsInNjcCI6ImVtYWlsIG9wZW5pZCBwcm9maWxlIiwic2lkIjoiMDA3ZDI3MjktZmRlMi0xZjUxLWU5Y2UtODg5NTE3NzA0YzA0Iiwic3ViIjoiODdnaFJRNmYwOTNwNUpPSjVPS092cl90UWNKU1F1SHFPdVVSWlRTLUY0dyIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6IjAwNjk2N2VlLTNkODQtNDFmOS1hMjJkLWZmNGFkZWMyNTMyMyIsInVuaXF1ZV9uYW1lIjoiYW5kcmVqcy5yQHhwZXJpZW5jZS5sdiIsInVwbiI6ImFuZHJlanMuckB4cGVyaWVuY2UubHYiLCJ1dGkiOiJodXliVkcxSGgwQ2toNG5Ob1pNTkFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2Z0ZCI6IjdPNTdvbHpFejMzX3BZN2dzajhmR09fd3gwZk1sWElybWhmTERVdUxUWjRCWlhWeWIzQmxibTl5ZEdndFpITnRjdyIsInhtc19pZHJlbCI6IjYgMSIsInhtc19zdCI6eyJzdWIiOiJmM09aaDkwbUpKNmJUZVdOQ19uVHNRM09DX2tDWUE0MVV0Z1hYZTVuTTljIn0sInhtc190Y2R0IjoxNjEyOTA3OTI3LCJ4bXNfdGRiciI6IkVVIn0.AYpUx0jWjdTOfzi18qeZBSKriTlUISlYjOdvGtBUjGVJy_47ihjVcEHphMuw-nG4ZBNWsUhgYUs3hqr7FKItsPJPGFnToDXYOQldY2JMHAYk4TSJaRXwxdKrvwuADOaZVfLMHuVo3ZNRReYf89Lq_Pgdjs7QalcEi6kd849u-EWRyHtWryfXjbZIvZBsgbh7OaozP0Nk2Jw1SbeDGB9XuxEZepgpurc48aKW07KWXq-dQyEovgKYS1l5CZ5ZzB0amH2l11ZuDHnZydEQcwN2Nx3XRaOluuTFmMwsdKrdxVD8Gy6dTjUqq7UfpdNFGPhp8SxUsrIcSlKwPgLPoxVodg",
    "refresh_token": "1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0aqAIeCAA.AgABAwEAAABVrSpeuWamRam2jAF1XRQEAwDs_wUA9P-ITgId1E_Tq4tOdpFLFh0WjvyBlQDZOoiEAZxE3UlCvmC_N2cmif0wGqgWAtRYI2EZcJgTHHZA_SM4q7N5wnvHS40_WJxk4d5vb922GEccY-FKfV1rejEI_xV6gGgR4H0JSM3CjDpcj2T-nrYjfF3MkNjymUp25GX3SdVBIXV1ij3ZOpOJ4gVEXhkoLAAnwuAH8yJGcoRcNIYIzB8Ec3p8G9BpjzZK1sxKWYviuOy19nqXNBU5_u54tybZl8MmJn4P8H-B0Px8n_J6ZhUqRg2xydo3dA098yaadhUV11n7UWY0RvC8k-azU7d5v3QysB2qTb1iZNH4zCnj8Ww-Bl3BqC-FYShaFXLt8YlayqikeoZiN6lyd1T0GjZ_v-cqLsVDbJygqYSehxJS40NXcemvxkdHagT_4q4wZSByVbrkdoPTzLySk5MJ-B2jxGWhUVODq6y_O9IZzCBN6ZwoMBS3c1O1RZLISaAT-QWmNCyiYBMeGK_yKoIDH2wpGjldYPgcLjR0eBuxkzXcC4AXyyVkjzr4sG8sJhatp4qnCv1LXHv1R5JLnmn97SB82Usc2CcWn01ay-qthO_poYMqa0BmSCTomuQDMoz_cEoHjEbnzCPfcyO-InGsPfobOe2e6esy7t_K6eq56esv7edDoTreNSyWPtZsFTrf44-HO0C_8az_25jksYt4ERBvw0exspWoOv9pD1ZbvEnQox14eDWmeyD0iZ5FLBflzuVDT_waYX1p-Vpzq0rQjSQ-MqZaM7OY4yBIw6fphTs45K3hVXJIbyZW7NGKPZ-7YZ2MH59O_rnwSucTehniUEhYvLdN2097__Q3FRknXZNvjFixDm-ar3li6A",
    "id_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSJ9.eyJhdWQiOiIwNTBlZDZkYS05YzFhLTRkYmUtYWU1OS1jYmJkMWNkNTZiNDYiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vMDA2OTY3ZWUtM2Q4NC00MWY5LWEyMmQtZmY0YWRlYzI1MzIzL3YyLjAiLCJpYXQiOjE3NTU2OTE3NTQsIm5iZiI6MTc1NTY5MTc1NCwiZXhwIjoxNzU1Njk1NjU0LCJlbWFpbCI6ImFuZHJlanMuckB4cGVyaWVuY2UubHYiLCJuYW1lIjoiQW5kcmVqcyBSaW1zZXZpY3MiLCJvaWQiOiIyNTJlMDFiMC0xN2ZiLTRiNTgtYjI5ZC00N2M4NjEwYTUwZDIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhbmRyZWpzLnJAeHBlcmllbmNlLmx2IiwicmgiOiIxLkFZSUE3bWRwQUlROS1VR2lMZjlLM3NKVEk5cldEZ1Vhbkw1TnJsbkx2UnpWYTBhcUFJZUNBQS4iLCJzaWQiOiIwMDdkMjcyOS1mZGUyLTFmNTEtZTljZS04ODk1MTc3MDRjMDQiLCJzdWIiOiJmM09aaDkwbUpKNmJUZVdOQ19uVHNRM09DX2tDWUE0MVV0Z1hYZTVuTTljIiwidGlkIjoiMDA2OTY3ZWUtM2Q4NC00MWY5LWEyMmQtZmY0YWRlYzI1MzIzIiwidXRpIjoiaHV5YlZHMUhoMENraDRuTm9aTU5BQSIsInZlciI6IjIuMCJ9.GBtY8xdimUcmMvABa8tP3GEVI_eI7GC_5ksC7A_iKefFMCr0sXCWN9a3lWg2cB0VFUtKfhqDIqWqiZ-vzB2Oi3oDibwlYwhkVPNqKRBUZkhPaRWR-jVPtrZ8LhRnzuoHmyNdo_DOeeFxkVyE3Jh1uW6A7fxt4SswcBtc0whKsi4INZZZoATfCwad7PQ-XZLPc_v5Q9mdovQ0u7t-oLKacTsXC1-bvLkV0CLGA1d2wsU1UNsDAkUxeTQrulYyn01vdVDgKq5jVMAALCdVyHetHKUDCCdQEnGRIV6ZGQz7wVzeYTyJRak7xkrA8lqOI8-p83uOdciPSOhF1iluGyNPIA",
    "expires_at": 1755696038,
    "provider": "microsoft-entra-id",
    "type": "oidc",
    "providerAccountId": "f3OZh90mJJ6bTeWNC_nTsQ3OC_kCYA41UtgXXe5nM9c"
  },
  "profile": {
    "aud": "050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46",
    "iss": "https://login.microsoftonline.com/006967ee-3d84-41f9-a22d-ff4adec25323/v2.0",
    "iat": 1755691754,
    "nbf": 1755691754,
    "exp": 1755695654,
    "email": "andrejs.r@xperience.lv",
    "name": "Andrejs Rimsevics",
    "oid": "252e01b0-17fb-4b58-b29d-47c8610a50d2",
    "preferred_username": "andrejs.r@xperience.lv",
    "rh": "1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0aqAIeCAA.",
    "sid": "007d2729-fde2-1f51-e9ce-889517704c04",
    "sub": "f3OZh90mJJ6bTeWNC_nTsQ3OC_kCYA41UtgXXe5nM9c",
    "tid": "006967ee-3d84-41f9-a22d-ff4adec25323",
    "uti": "huybVG1Hh0Ckh4nNoZMNAA",
    "ver": "2.0"
  },
  "cookies": [
    {
      "name": "authjs.pkce.code_verifier",
      "value": "",
      "options": {
        "httpOnly": true,
        "sameSite": "lax",
        "path": "/",
        "secure": false,
        "maxAge": 0
      }
    }
  ]
}
[auth][debug]: CHUNKING_SESSION_COOKIE {
  "message": "Session cookie exceeds allowed 4096 bytes.",
  "emptyCookieSize": 160,
  "valueSize": 4979,
  "chunks": [
    4096,
    1203
  ]
}
 GET /api/auth/callback/microsoft-entra-id?code=1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0a4AACCAA.AgABBAIAAABVrSpeuWamRam2jAF1XRQEAwDs_wUA9P-cLb8Morxh1VLs__c3AdKmGWFXygSlJSjUJpXTF_BLNrKjd1TCA1W466M_k3BIj4CnmgAt9dqIRrZjGXy9rAJHfVoypnkGuW1PdvUix3f2KZIACldBgHO1dVhaZdw-Eplxq8zW7ZNwOYWG4xPTHKGWjYuxanrZ8Drg-sHEfnEfn9AtAj21ouSoFx8b77tNpZ-9GF7LPF7rC_G_5zcTushOVs_z9bM_Bw9Rs7Xbffu_SciTneWUe3ckCC-gwRShYKT26POAUcsEu6p8cmMh6usJBHSWDmomKi2RlSHEIbsN5rmHxDhHliUXfvzZNceOA-tR0t2f4rCKvKTfhyXnlYd-_HCLOx3FIB1HhFq_--Oyel0so2JxxbBruiXt96UF19DTpSh60mJy_0Fbyse-XuWVu-FGN1nM6583SrACNDeVVLw5SrKs9H9eq74dh1771hOL_9kIuIOwegLZ9K8ai11iwGmcOMvtc0ixTISskch9PTG8SEsa1MMTtC_-InHSO85mwwFg3IGo5AyLHWOmcDhoUY4qYevt_GdbURpzzAmV2BgT7EGlPQ5cvDZDrGWSi6xOSc9TZMvQnYl-hFw_GjsjqoWOW4P6DwpQzcwEfWfFre05MGdznXocRvPPM9OR0fO78tY46hem-4EG6WjA0JXcpeCfvAwDuUIHam9VtxlPl0Ut-nhFWRidxSgQbIUukvm6u-N2mlImjBIB5Z2QiTEAhvzfVjyQCgjnTNOD8vIjRi167t7Whpfmc-UawUbCWpRVHLJBizD4ttIOfV7eyv2l3CPEvxsEXfxycascI4J07pUzg8cWD3yPoQ-jc-dUsSVn9BOcveDAcuaQDOKlCPtarA5eZiymmzy8GP1gq7bO3eGF&session_state=007d2729-fde2-1f51-e9ce-889517704c04 302 in 2593ms
[auth][error] JWTSessionError: Read more at https://errors.authjs.dev#jwtsessionerror
[auth][cause]: TypeError: {(intermediate value)(intermediate value)(intermediate value)(intermediate value)} is not a function
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/[root-of-the-server]__3d4f3649._.js:74:19)
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_7dffea22._.js:3787:50)
    at Module.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:4487:52)
    at async AuthInternal (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:5049:24)
    at async Auth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:5299:34)
    at async handleAuth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_7dffea22._.js:3892:29)
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:12293:20
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:6734:28
    at async adapter (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:6685:16)
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/node_modules/next/dist/server/web/sandbox/sandbox.js:109:26
[auth][details]: {}
[auth][error] JWTSessionError: Read more at https://errors.authjs.dev#jwtsessionerror
[auth][cause]: TypeError: {(intermediate value)(intermediate value)(intermediate value)(intermediate value)} is not a function
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/[root-of-the-server]__ce392fdd._.js:66:19)
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_eddea57e._.js:3805:50)
    at Module.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:4486:52)
    at async AuthInternal (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:5048:24)
    at async Auth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:5298:34)
    at async Home (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/[root-of-the-server]__ce392fdd._.js:117:21)
[auth][details]: {}
 GET / 200 in 67ms
 GET / 200 in 58ms
[auth][debug]: CREATE_PKCECODEVERIFIER {
  "name": "authjs.pkce.code_verifier",
  "payload": "ORG-0r_VwN9MxVUZtRyvu0iOhxt3WqZGS6cvuzEAkGM",
  "COOKIE_TTL": 900,
  "expires": "2025-08-20T12:30:10.494Z"
}
[auth][debug]: authorization url is ready {
  "url": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fapi%2Fauth%2Fcallback%2Fmicrosoft-entra-id&scope=openid+profile+email+offline_access&code_challenge=Mpkfve72c6eaH6fHwrdRN3FbHXLF8GFRsQJ1Dqujwv0&code_challenge_method=S256",
  "cookies": [
    {
      "name": "authjs.pkce.code_verifier",
      "value": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..nGGZw3egcNzXXQnTIcUiIw.tKv_vVwvzyh97aynPVPcF1oC3m0AU1empsDNT52gWXl3EKuSo8BbA0xA6MVfhmfbyFEWGJitz9CPpdXVG2p6EDhoOeDoLROKcNZRDro9-aed2CZJXxiVUi_SKKuYRV9CS9aMtkPTModB1N3S3FXykqK-RDFs4WBuOJT9Tt_Wcr2chz1qLp0iap_GXQLRNo_R.guSXrF8RbjFah3XObccyt8cBXQweku2AaTDGsTOYewA",
      "options": {
        "httpOnly": true,
        "sameSite": "lax",
        "path": "/",
        "secure": false,
        "maxAge": 900,
        "expires": "2025-08-20T12:30:10.494Z"
      }
    }
  ],
  "provider": {
    "id": "microsoft-entra-id",
    "name": "Microsoft Entra ID",
    "type": "oidc",
    "authorization": {
      "url": "https://authjs.dev/?scope=openid+profile+email+offline_access"
    },
    "style": {
      "text": "#fff",
      "bg": "#0072c6"
    },
    "clientId": "050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46",
    "clientSecret": "m6-8Q~B02nqBmQkY3X6b5iWhIj4izfT3P4X6jb97",
    "issuer": "https://login.microsoftonline.com/common/v2.0",
    "tenantId": "88035477-cea5-4eaf-bafc-efa3e368ad5e",
    "signinUrl": "http://localhost:3000/api/auth/signin/microsoft-entra-id",
    "callbackUrl": "http://localhost:3000/api/auth/callback/microsoft-entra-id",
    "wellKnown": "https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration",
    "checks": [
      "pkce"
    ]
  }
}
 POST / 303 in 207ms
[auth][debug]: USE_PKCECODEVERIFIER {
  "value": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..nGGZw3egcNzXXQnTIcUiIw.tKv_vVwvzyh97aynPVPcF1oC3m0AU1empsDNT52gWXl3EKuSo8BbA0xA6MVfhmfbyFEWGJitz9CPpdXVG2p6EDhoOeDoLROKcNZRDro9-aed2CZJXxiVUi_SKKuYRV9CS9aMtkPTModB1N3S3FXykqK-RDFs4WBuOJT9Tt_Wcr2chz1qLp0iap_GXQLRNo_R.guSXrF8RbjFah3XObccyt8cBXQweku2AaTDGsTOYewA"
}
[auth][debug]: PARSE_PKCECODEVERIFIER {
  "cookie": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiMWcwQk9Cd0NqSlV2bDlrRXBsQ0cwZHJxSjEzVXpmVm1LV3JJR3dYNmRLR2VpYmYzYnNWQ3pXN3h5VGU5MDhGODV3alM3YlhpNzlGTUR4b2NVY0psancifQ..nGGZw3egcNzXXQnTIcUiIw.tKv_vVwvzyh97aynPVPcF1oC3m0AU1empsDNT52gWXl3EKuSo8BbA0xA6MVfhmfbyFEWGJitz9CPpdXVG2p6EDhoOeDoLROKcNZRDro9-aed2CZJXxiVUi_SKKuYRV9CS9aMtkPTModB1N3S3FXykqK-RDFs4WBuOJT9Tt_Wcr2chz1qLp0iap_GXQLRNo_R.guSXrF8RbjFah3XObccyt8cBXQweku2AaTDGsTOYewA"
}
[auth][debug]: CLEAR_PKCECODEVERIFIER {
  "cookie": {
    "name": "authjs.pkce.code_verifier",
    "options": {
      "httpOnly": true,
      "sameSite": "lax",
      "path": "/",
      "secure": false,
      "maxAge": 900
    }
  }
}
[auth][debug]: authorization result {
  "user": {
    "id": "e01682f1-dbea-42e5-a8d7-72d8608e145c",
    "name": "Andrejs Rimsevics",
    "email": "andrejs.r@xperience.lv",
    "image": null
  },
  "account": {
    "token_type": "bearer",
    "scope": "email openid profile",
    "expires_in": 5180,
    "ext_expires_in": 5180,
    "access_token": "eyJ0eXAiOiJKV1QiLCJub25jZSI6Ik1XcmxuVDlhNkhGaFlJNVB1X1A2UGZnN3hoc08xSVRPQjgyMTlKcjNNdlEiLCJhbGciOiJSUzI1NiIsIng1dCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSIsImtpZCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8wMDY5NjdlZS0zZDg0LTQxZjktYTIyZC1mZjRhZGVjMjUzMjMvIiwiaWF0IjoxNzU1NjkxODUxLCJuYmYiOjE3NTU2OTE4NTEsImV4cCI6MTc1NTY5NzMzMiwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsicDEiXSwiYWlvIjoiQVpRQWEvOFpBQUFBU2M3WC9aRDRhZnoyVGNRMGFJeFhmSU1KK3lsOVlSWDB5RWx2T3dkQTFqU3U1RXB4MzVYNU85ZjBIU2phdjFTMHcvZUEwdVVYSktjL3F3RnJmeUJGSWszR29mSFJpQVU4alFVVTYxTmxST2FhaTBKZlRxY2E2dWpsTzJ1QzJMczhiZU9NYnFJY0hEazlOZ2JkeWdYMDVpRDFlVU0wUnpMcjE4VE5PVjA2YzZZTEdEcW42SWorSHczS2VSeEpKZDk1IiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBfZGlzcGxheW5hbWUiOiJuZXh0anMtcG9jIiwiYXBwaWQiOiIwNTBlZDZkYS05YzFhLTRkYmUtYWU1OS1jYmJkMWNkNTZiNDYiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6IlJpbXNldmljcyIsImdpdmVuX25hbWUiOiJBbmRyZWpzIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiODMuOTkuMTM3LjczIiwibmFtZSI6IkFuZHJlanMgUmltc2V2aWNzIiwib2lkIjoiMjUyZTAxYjAtMTdmYi00YjU4LWIyOWQtNDdjODYxMGE1MGQyIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAzQTM4MDM1REIiLCJyaCI6IjEuQVlJQTdtZHBBSVE5LVVHaUxmOUszc0pUSXdNQUFBQUFBQUFBd0FBQUFBQUFBQUNxQUllQ0FBLiIsInNjcCI6ImVtYWlsIG9wZW5pZCBwcm9maWxlIiwic2lkIjoiMDA3ZDI3MjktZjAyOS03ZmNjLWFkZjAtMDM2NzgwNDE1NzQ0Iiwic3ViIjoiODdnaFJRNmYwOTNwNUpPSjVPS092cl90UWNKU1F1SHFPdVVSWlRTLUY0dyIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6IjAwNjk2N2VlLTNkODQtNDFmOS1hMjJkLWZmNGFkZWMyNTMyMyIsInVuaXF1ZV9uYW1lIjoiYW5kcmVqcy5yQHhwZXJpZW5jZS5sdiIsInVwbiI6ImFuZHJlanMuckB4cGVyaWVuY2UubHYiLCJ1dGkiOiJrcmpLRWtFclNrV2tmcXpubUxjRkFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2Z0ZCI6InMta05XRUV5ODk1NFhPODZ1V1pBenVFeks1Qk1iY2tYek1CNXEzeEJZLTBCYzNkbFpHVnVZeTFrYzIxeiIsInhtc19pZHJlbCI6IjggMSIsInhtc19zdCI6eyJzdWIiOiJmM09aaDkwbUpKNmJUZVdOQ19uVHNRM09DX2tDWUE0MVV0Z1hYZTVuTTljIn0sInhtc190Y2R0IjoxNjEyOTA3OTI3LCJ4bXNfdGRiciI6IkVVIn0.Pvvl0UrbSmm-InLREJGWbJEkP6lgqKU0X1Ay0p7FSmofuHMa1eQZhTot6Iq8d7q8XZ9KtJwcE6ISZ4vvxRio__N0CdXK7Ts78cjO0-OntopXmxBWmgy5PEnqO3PMcU8CJgmk0aULTIMmeHHwPXpJucYhDZfpacUVGghT8Sk3XhO2xSFfJQx-rdo5NzibCoaDuEeolGvj5LVqo-ZjqkzrHfziVl6XUTRfxhrEt7d2VN_PKAP0qg6LoxhyVhbCR2y7TjdHswPxCWIVPYPyl0-FR9mdnx8grMhANddAzLhse2wMvGe-tz3G7-6Mnh-qc1DIrwmggD3owhe2W6pB1Kf8Fw",
    "refresh_token": "1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0aqAIeCAA.AgABAwEAAABVrSpeuWamRam2jAF1XRQEAwDs_wUA9P_vhwSrKMg3tM5JrP1qQ04OrzuBo0nRa8fEzfcry2KDOrky912YUR-eXBB6eewmVBmUgSiSDLMb1U7urGU1yv0ThT3MMUgHa-nHXPvs4_kJHILVjAeFiEYx1M7n34KLYaqrb794rqX76_XI5M0h9JiKDt33q9fXMAY_ZVgbZVY8sS5UbJcATDtZfKDkOsUcz66lpu9NZt7c-6dQOFhDMCyIIqJ9AKenniuESj8tCyV66T75Fm22UZcSD_kIbQVXX_ZOqGvgOu20EvLTjF8-0nD99Edyjp-_dMCykuBQd99Ut3RhSJ2gvkqVsgIDveVML7Env9ug7QK-_GJoWxxWsp3OCo-UuZ0TZlEbd1YZqw09AjVVDyUSiPGQkUw-xgEpAQYUnD3ojLIpuIGAlUamZxS8MTP66UyjZkUh0q2umMveUQtYJ7poHjjnOXa4SkwP06vSh5Wi4fXRl3gOtwLdXEfGXo0N0U9Gr76lFWvXNFbZyDKA2DSKCUtgdmQIU5VX_X-l8seDiwMgEIIXe3fbkVVOgk2HexHjRUOMiSQmDYbtC6NrFQRh2lDturz4CD2wqkR76lDbU7FNNslrXd0TOxB-94ugLh8yJ-kqceoN6VjrujT-CRtsLm42zBlb9gYA4Mgz4HFGmMj5Tiyiz9l3heTo387jStQbZW8hzIGtf0CCWgXrTJE5WtYsvdG_otz5nWgDqXFSB0rd63ZcJRyzdbQJt76thQEvJx_IIUStXyTcjUjk3NtieCQHxnumD_Ql9KVx9KO-NKGug7rD-cL3aBuc7S8dzMQeJE7c-fezGrByXE4vCT7WRbyFJGIvjbGiiZhXhHPoucyp7_HU4OTOVo6jDS36uA",
    "id_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSJ9.eyJhdWQiOiIwNTBlZDZkYS05YzFhLTRkYmUtYWU1OS1jYmJkMWNkNTZiNDYiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vMDA2OTY3ZWUtM2Q4NC00MWY5LWEyMmQtZmY0YWRlYzI1MzIzL3YyLjAiLCJpYXQiOjE3NTU2OTE4NTEsIm5iZiI6MTc1NTY5MTg1MSwiZXhwIjoxNzU1Njk1NzUxLCJlbWFpbCI6ImFuZHJlanMuckB4cGVyaWVuY2UubHYiLCJuYW1lIjoiQW5kcmVqcyBSaW1zZXZpY3MiLCJvaWQiOiIyNTJlMDFiMC0xN2ZiLTRiNTgtYjI5ZC00N2M4NjEwYTUwZDIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhbmRyZWpzLnJAeHBlcmllbmNlLmx2IiwicmgiOiIxLkFZSUE3bWRwQUlROS1VR2lMZjlLM3NKVEk5cldEZ1Vhbkw1TnJsbkx2UnpWYTBhcUFJZUNBQS4iLCJzaWQiOiIwMDdkMjcyOS1mMDI5LTdmY2MtYWRmMC0wMzY3ODA0MTU3NDQiLCJzdWIiOiJmM09aaDkwbUpKNmJUZVdOQ19uVHNRM09DX2tDWUE0MVV0Z1hYZTVuTTljIiwidGlkIjoiMDA2OTY3ZWUtM2Q4NC00MWY5LWEyMmQtZmY0YWRlYzI1MzIzIiwidXRpIjoia3JqS0VrRXJTa1drZnF6bm1MY0ZBQSIsInZlciI6IjIuMCJ9.dYn5DXdrte-Oj3W2cI7si7ni0WLYszT1SnYWmmuGR0r0M6kejGV9c_4Is7ApNNTlE3SoTn8aDk_9syvM4Nagn59eoDzMBuIoyYPYvbCb7Z7KKTh8_mwqLO5crfIvEUIny_Q46dKFDl-YNVHK3XJOQ1_AEwLHEVgfW02KB_Y4_mmERFYpDpbJJzzqTDkheyPYjTiTFPV3Oecf8zP5sETxR80zrYBKRfn4qZnC0zsbxp6SpNjWv0P7I_4gUpJa6tknfjBqn5IT8t-3O34FWtne5yL2Y9q5s9giLs8_1fJqhYSYRAkLJy--WgJXFXK6wObRciPre4HAB6mb4ieMCB28vA",
    "expires_at": 1755697332,
    "provider": "microsoft-entra-id",
    "type": "oidc",
    "providerAccountId": "f3OZh90mJJ6bTeWNC_nTsQ3OC_kCYA41UtgXXe5nM9c"
  },
  "profile": {
    "aud": "050ed6da-9c1a-4dbe-ae59-cbbd1cd56b46",
    "iss": "https://login.microsoftonline.com/006967ee-3d84-41f9-a22d-ff4adec25323/v2.0",
    "iat": 1755691851,
    "nbf": 1755691851,
    "exp": 1755695751,
    "email": "andrejs.r@xperience.lv",
    "name": "Andrejs Rimsevics",
    "oid": "252e01b0-17fb-4b58-b29d-47c8610a50d2",
    "preferred_username": "andrejs.r@xperience.lv",
    "rh": "1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0aqAIeCAA.",
    "sid": "007d2729-f029-7fcc-adf0-036780415744",
    "sub": "f3OZh90mJJ6bTeWNC_nTsQ3OC_kCYA41UtgXXe5nM9c",
    "tid": "006967ee-3d84-41f9-a22d-ff4adec25323",
    "uti": "krjKEkErSkWkfqznmLcFAA",
    "ver": "2.0"
  },
  "cookies": [
    {
      "name": "authjs.pkce.code_verifier",
      "value": "",
      "options": {
        "httpOnly": true,
        "sameSite": "lax",
        "path": "/",
        "secure": false,
        "maxAge": 0
      }
    }
  ]
}
[auth][debug]: CHUNKING_SESSION_COOKIE {
  "message": "Session cookie exceeds allowed 4096 bytes.",
  "emptyCookieSize": 160,
  "valueSize": 4979,
  "chunks": [
    4096,
    1203
  ]
}
 GET /api/auth/callback/microsoft-entra-id?code=1.AYIA7mdpAIQ9-UGiLf9K3sJTI9rWDgUanL5NrlnLvRzVa0a4AACCAA.AgABBAIAAABVrSpeuWamRam2jAF1XRQEAwDs_wUA9P80UUmhjMOccj05esB841q5FbXl0O1VmWsRmqtHEJwuM2wLiQQtIJnVIa6mdDn8X5SLSYc2gxEDaqkYPhedKLXuskBunYllZYqzEYcpRlnH34yzjfbzjonprgkSilE8K5tysSwZu9e0WrWn8YkjxfRBB_alrw-yyCtMJ3WRx15cxw1ZMEr9t0oFbcWYRkELMpuBq-J9pJ-AIN-3WFgFuCt1mtFI-_9OVpPH4O_5XyXV-NjZ58ctFzkC9a-BPgMskkHQGm_aoCzd0vkv-i4rsBfIJdBkpEKekKFdSluaBhOsVcFJzrb0gigLd_12sCtyuZ_rQ9f9eA7iER7mxfFFu0YQeuLvjjHLqSfpMpUrMu0Gp3N7iJUQkUs2p2S8RDdi1a9DMrsm6h2jbtt6MJWuOC9aJtZMCJUMKQSkOAfEAYDWMKh8iWteKrx9NFfkjjX_-MHPNGTD25k-DOiX4EkaBdVCNiEU2GT1SYXPcIsOT8NeFCQ9citRtgKx53XoWHDXsDAa7P78Ui-3pJWsa6It4izENEJcO_3DvGUCx_kqBRjwQK08kbgcFxe5LT8Bfj8AUjvjUYLT7BUf6eKwWc-O3bEGWYQx84sb8snuNoM4rcfanoQVoK-tEYyx0kL-6abmv3YIyC7O9O9NTBPKroYtj48d364w-KFjh-PKDUYKx_Io_GdJ9HqqrEZKIHAMZuDZJoudRuhK9joe9dUft_25wxruljXGBRuM6rY5dOh0wYkCWc_tfyl4BqF2Kd9OupOw1YAEF2RvzhqT0U4ywtZykdGb88l5ocP_F891-8wZU4oT97jTp-K7-PN3UCuID1E2lGw5uDesqr9Ch64HjunrYWjXsJVUGfJcZqMOBZmWUon_WwSUrLIz2w&session_state=007d2729-f029-7fcc-adf0-036780415744 302 in 1567ms
[auth][error] JWTSessionError: Read more at https://errors.authjs.dev#jwtsessionerror
[auth][cause]: TypeError: {(intermediate value)(intermediate value)(intermediate value)(intermediate value)} is not a function
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/[root-of-the-server]__3d4f3649._.js:74:19)
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_7dffea22._.js:3787:50)
    at Module.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:4487:52)
    at async AuthInternal (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:5049:24)
    at async Auth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_@auth_core_3127a18d._.js:5299:34)
    at async handleAuth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/node_modules_7dffea22._.js:3892:29)
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:12293:20
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:6734:28
    at async adapter (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/edge/chunks/_da5a9c44._.js:6685:16)
    at async /home/rimkus/git/entraid/nextjs-entraid-auth/example/node_modules/next/dist/server/web/sandbox/sandbox.js:109:26
[auth][details]: {}
[auth][error] JWTSessionError: Read more at https://errors.authjs.dev#jwtsessionerror
[auth][cause]: TypeError: {(intermediate value)(intermediate value)(intermediate value)(intermediate value)} is not a function
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/[root-of-the-server]__ce392fdd._.js:66:19)
    at Object.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_eddea57e._.js:3805:50)
    at Module.session (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:4486:52)
    at async AuthInternal (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:5048:24)
    at async Auth (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/node_modules_@auth_core_7b8cb6eb._.js:5298:34)
    at async Home (/home/rimkus/git/entraid/nextjs-entraid-auth/example/.next/server/chunks/ssr/[root-of-the-server]__ce392fdd._.js:117:21)
[auth][details]: {}
 GET / 200 in 61ms
 
 -----
 
 rimkus@DESKTOP-IHA3IIP:~/git/entraid$ ./launch-demo.sh
ğŸš€ Microsoft Entra ID + Next.js Authentication Demo
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ Project: nextjs-entraid-auth/example
ğŸ§¹ Cleaning up any existing processes...
  8147ğŸŒ Starting development server...

â³ Waiting for server to start...

> example@0.1.0 dev
> next dev --turbopack --hostname 0.0.0.0 --port 3000

   â–² Next.js 15.4.6 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://0.0.0.0:3000
   - Environments: .env.local

 âœ“ Starting...
 âœ“ Compiled middleware in 176ms
 âœ“ Ready in 1089ms
 â¨¯ Error: Could not parse module '[project]/auth.ts'

Expected ';', '}' or <eof>
    at [project]/auth.ts [middleware-edge] (ecmascript) (.next/server/edge/chunks/[root-of-the-server]__3d4f3649._.js:23:11)
    at [project]/middleware.ts [middleware-edge] (ecmascript) (middleware.ts:1:0)
> 1 | import { auth } from "./auth"
  2 | import { NextResponse } from "next/server"
  3 |
  4 | export default auth((req) => {
 â—‹ Compiling /_error ...

âœ… Server started successfully!

ğŸŒ Access URLs:
   â€¢ Local: http://localhost:3000
   â€¢ Network: http://10.255.255.254:3000

ğŸ“‹ Features you can test:
   â€¢ Home page with demo interface
   â€¢ Click 'Protected Page' button (will redirect to login)
   â€¢ Click 'Admin Page' button (will redirect to login)
   â€¢ Sign in button (will show Entra ID setup needed)

ğŸ’¡ To enable full authentication:
   1. Set up Microsoft Entra ID app registration
   2. Edit .env.local with your real credentials
   3. Follow: ~/git/entraid/nextjs-entraid-auth/SETUP-GUIDE.md

ğŸ”§ Setting up Windows port forwarding...
   Run this in Windows PowerShell as Administrator:
   netsh interface portproxy delete v4tov4 listenport=3000
   netsh interface portproxy add v4tov4 listenport=3000 listenaddress=0.0.0.0 connectport=3000 connectaddress=127.0.0.1

â¹ï¸  Press Ctrl+C to stop the server
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 âœ“ Compiled /_error in 1042ms
 GET / 404 in 4ms
 â—‹ Compiling /_not-found/page ...
 âœ“ Compiled /_not-found/page in 2.1s
 â¨¯ Error: Could not parse module '[project]/auth.ts'

Expected ';', '}' or <eof>
    at [project]/auth.ts [middleware-edge] (ecmascript) (.next/server/edge/chunks/[root-of-the-server]__3d4f3649._.js:23:11)
    at [project]/middleware.ts [middleware-edge] (ecmascript) (middleware.ts:1:0)
> 1 | import { auth } from "./auth"
  2 | import { NextResponse } from "next/server"
  3 |
  4 | export default auth((req) => {
 GET / 404 in 1ms
 
 -----